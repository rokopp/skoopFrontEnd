<div class="container-fluid m-0">
  <div class="row m-0">

    <div class="col-12 text-center my-4">
      <h1>Editing Question Set {{setName}}</h1>
    </div>
  </div>

  <div class="container">
    <div class="row m-0 text-center">
      <div class="col-sm-12 col-md-12 col-lg-10 " id="questions">
        <h2>View created Questions</h2>
        <!--Using mat-table from Angular Material, check the API at https://material.angular.io/components/table/api-->
        <!--TODO: notify table of updates via renderRows()-->
        <!--Excuse me, mr table, but umm.. renderCows.. i meant.. renderRows()!-->
        <table mat-table [dataSource]="questionSet">

          <!-- ID column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef class="text-center">ID</th>
            <td mat-cell *matCellDef="let elem">{{elem.id}}</td>
          </ng-container>

          <!-- Question column -->
          <ng-container matColumnDef="question">
            <th mat-header-cell *matHeaderCellDef class="text-center">Question</th>
            <td mat-cell *matCellDef="let elem">{{elem.questionText}}</td>
          </ng-container>

          <!-- Answer column -->
          <ng-container matColumnDef="answer">
            <th mat-header-cell *matHeaderCellDef class="text-center">Answer</th>
            <td mat-cell *matCellDef="let elem">{{elem.answer}}</td>
          </ng-container>

          <!-- Type column -->
          <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef class="text-center">Type</th>
            <td mat-cell *matCellDef="let elem">{{elem.type}}</td>
          </ng-container>

          <!-- Hint column -->
          <ng-container matColumnDef="hint">
            <th mat-header-cell *matHeaderCellDef class="text-center">Type</th>
            <td mat-cell *matCellDef="let elem">{{elem.hint}}</td>
          </ng-container>

          <!-- Action column
              Edit and Delete functions
              If Edit is clicked on a certain row, change it for Update to Update Question
              On edit data is written into our Question form.
          -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef class="text-center"> Action </th>
            <td mat-cell *matCellDef="let element" class="action-link">
              <a (click)="editQuestion(element); openModal('custom-modal-1', element);"
                 class="btn btn-outline-dark w-auto">Edit</a>
              <a (click)="deleteQuestion(element)" class="btn btn-outline-danger w-auto margin-t2
              mt-lg-0 margin-l2-btn">Delete</a>
            </td>
          </ng-container>

          <!-- Draw rows and columns -->
          <tr mat-header-row  *matHeaderRowDef="columnsToDisplay"></tr>
          <tr mat-row class="row-height" *matRowDef="let row; columns: columnsToDisplay"></tr>
        </table>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-4">
        <!-- Trigger Create Multi Answer Modal -->
        <button type="button" class="btn btn-info" (click)="openModalForCreating('multipleChoices');">
          Loo valikvastustega küsimustik
        </button>
      </div>
      <div class="col-4">
        <!-- Trigger Create Checkbox Modal -->
        <button type="button" class="btn btn-primary" (click)="openModalForCreating('checkbox');">
          Loo CHECKBOX küsimustik
        </button>
      </div>
      <div class="col-4">
        <!-- Trigger Create Text Modal -->
        <button type="button" class="btn btn-dark" (click)="openModalForCreating('text');">
          Loo TEXT
        </button>
      </div>
    </div>
  </div>
</div>

<!--TODO edit by question type-->
<!--Question editing-->
<jw-modal id="custom-modal-1">
  <div class="col-sm-12 col-md-12 col-lg-12 form text-center">
    <h2>Muuda küsimust</h2>
    <form class="question-form">

      <mat-form-field class="question" appearance="outline">
        <mat-label>Küsimus</mat-label>
        <input id="questionEdit" matInput name="question" type="text" required>
      </mat-form-field>

      <br>

      <mat-form-field class="choices text-center mb-3">
        <mat-chip-list #chipList aria-label="Choices">
          <mat-chip *ngFor="let choice of choices; let id = index" [selectable]="selectable" [removable]="removable"
                    (removed)="remove(choice, 'edit')" color="green" [ngClass]="setBg(id, 'edit')" [attr.isSelected]="false" (click)="selectCorrectAnswer(id, choice, 'edit')" id="edit_choice_{{id}}">
            {{choice.text}}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input [required] placeholder="Valikvastused: vajuta Enter et lisada ja Delete et kustutada. Lisaks vajuta et valida õige vastus"
                 [matChipInputFor]="chipList"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="addOnBlur"
                 (matChipInputTokenEnd)="addAnswer($event, 'edit')">
        </mat-chip-list>
      </mat-form-field>

      <br>

      <mat-form-field class="correctAnswer text-center mx-md-auto mr-lg-2 mb-lg-3" style="" appearance="fill">
        <mat-label style="">Correct answer</mat-label>
        <input id="answerEdit" type="text" matInput name="answer" required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Pluss punkte</mat-label>
        <input id="pointsTrueEdit" type="number" matInput required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Miinus punkte</mat-label>
        <input id="pointsFalseEdit" type="number" matInput required>
      </mat-form-field>

      <br>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary mx-auto" (click)="closeModal('custom-modal-1');">Sulge</button>
        <a (click)="updateQuestion(this.modalService.getElementQuestion(), '')" class="btn btn-outline-info w-auto">Uuenda</a>
        <button type="reset" class="btn btn-danger mx-auto" (click)="emptyChoices()">Tühjenda kõik väljad</button>
      </div>
    </form>
  </div>
</jw-modal>

<!--Valikvastustega-->
<jw-modal id="multipleChoices">
  <div class="col-sm-12 col-md-12 col-lg-12 form text-center">
    <h2>Loo valikvastustega</h2>
    <form class="question-form">

      <mat-form-field class="question" appearance="outline">
        <mat-label>Küsimus</mat-label>
        <input id="questionMultipleChoices" matInput name="question" type="text" required>
      </mat-form-field>

      <br>

      <mat-form-field class="choices text-center mb-3">
        <mat-chip-list #chipListMultipleChoices aria-label="Choices">
          <mat-chip *ngFor="let choice of choicesMultiple; let id = index" [selectable]="selectable" [removable]="removable"
                    (removed)="remove(choice, 'multipleChoices')" color="green" [ngClass]="setBg(id, 'multipleChoices')" [attr.isSelected]="false" (click)="selectCorrectAnswer(id, choice, 'multipleChoices')" id="multipleChoices_choice_{{id}}">
            {{choice.text}}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input [required] placeholder="Valikvastused: vajuta Enter et lisada ja Delete et kustutada. Lisaks vajuta et valida õige vastus"
                 [matChipInputFor]="chipListMultipleChoices"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="addOnBlur"
                 (matChipInputTokenEnd)="addAnswer($event, 'multipleChoices')">
        </mat-chip-list>
      </mat-form-field>

      <br>

      <mat-form-field class="correctAnswer text-center mx-md-auto mr-lg-2 mb-lg-3" style="" appearance="fill">
        <mat-label style="">Correct answer</mat-label>
        <input id="answerMultipleChoices" type="text" matInput name="answer" required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Pluss punkte</mat-label>
        <input id="pointsTrueMultipleChoices" type="number" matInput required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Miinus punkte</mat-label>
        <input id="pointsFalseMultipleChoices" type="number" matInput required>
      </mat-form-field>

      <br>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary mx-auto" (click)="closeModal('multipleChoices');">Sulge</button>
        <button type="submit" (click)="addQuestion('MultipleChoices')" class="btn btn-success mx-auto">Lisa küsimus</button>
        <button type="reset" class="btn btn-danger mx-auto" (click)="emptyChoices()">Tühjenda kõik väljad</button>
      </div>
    </form>
  </div>
</jw-modal>

<!--checkbox-->
<jw-modal id="checkbox">
  <div class="col-sm-12 col-md-12 col-lg-12 form text-center">
    <h2>Loo valikvastustega</h2>
    <form class="question-form">

      <mat-form-field class="question" appearance="outline">
        <mat-label>Küsimus</mat-label>
        <input id="questionCheckbox" matInput name="question" type="text" required>
      </mat-form-field>

      <br>

      <mat-form-field class="choices text-center mb-3">
        <mat-chip-list #chipListCheckbox aria-label="Choices">
          <mat-chip *ngFor="let choice of choicesCheckbox; let id = index" [selectable]="selectable" [removable]="removable"
                    (removed)="remove(choice, 'checkbox')" color="green" [ngClass]="setBg(id, 'checkbox')" [attr.isSelected]="false" (click)="selectCheckBoxCorrectAnswer(id, choice, 'checkbox')" id="checkbox_choice_{{id}}">
            {{choice.text}}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input [required] placeholder="Valikvastused: vajuta Enter et lisada ja Delete et kustutada. Lisaks vajuta et valida õige vastus"
                 [matChipInputFor]="chipListCheckbox"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="addOnBlur"
                 (matChipInputTokenEnd)="addAnswer($event, 'checkbox')">
        </mat-chip-list>
      </mat-form-field>

      <br>

      <mat-form-field class="correctAnswer text-center mx-md-auto mr-lg-2 mb-lg-3" style="" appearance="fill">
        <mat-label style="">Correct answer</mat-label>
        <input id="answerCheckbox" type="text" matInput name="answer" required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Pluss punkte</mat-label>
        <input id="pointsTrueCheckbox" type="number" matInput required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Miinus punkte</mat-label>
        <input id="pointsFalseCheckbox" type="number" matInput required>
      </mat-form-field>

      <br>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary mx-auto" (click)="closeModal('checkbox');">Sulge</button>
        <button type="submit" (click)="addQuestion('Checkbox')" class="btn btn-success mx-auto">Lisa küsimus</button>
        <button type="reset" class="btn btn-danger mx-auto" (click)="emptyChoices()">Tühjenda kõik väljad</button>
      </div>
    </form>
  </div>
</jw-modal>

<!--text-->
<jw-modal id="text">
  <div class="col-sm-12 col-md-12 col-lg-12 form text-center">
    <h2>Loo valikvastustega</h2>
    <form class="question-form">

      <mat-form-field class="question" appearance="outline">
        <mat-label>Küsimus</mat-label>
        <input id="questionText" matInput name="question" type="text" required>
      </mat-form-field>

      <br>

      <mat-form-field class="choices text-center mb-3">
        <mat-chip-list #chipListText aria-label="Choices">
          <mat-chip *ngFor="let choice of choicesText; let id = index" [selectable]="selectable" [removable]="removable"
                    (removed)="remove(choice, 'text')" color="green" [ngClass]="setBg(id, 'text')" [attr.isSelected]="false" (click)="selectCorrectAnswer(id, choice, 'text')" id="text_choice_{{id}}">
            {{choice.text}}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input [required] placeholder="Valikvastused: vajuta Enter et lisada ja Delete et kustutada. Lisaks vajuta et valida õige vastus"
                 [matChipInputFor]="chipListText"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="addOnBlur"
                 (matChipInputTokenEnd)="addAnswer($event, 'text')">
        </mat-chip-list>
      </mat-form-field>

      <br>

      <mat-form-field class="correctAnswer text-center mx-md-auto mr-lg-2 mb-lg-3" style="" appearance="fill">
        <mat-label style="">Correct answer</mat-label>
        <input id="answerText" type="text" matInput name="answer" required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Pluss punkte</mat-label>
        <input id="pointsTrueText" type="number" matInput required>
      </mat-form-field>

      <mat-form-field class="points text-center ml-lg-2" appearance="fill">
        <mat-label>Miinus punkte</mat-label>
        <input id="pointsFalseText" type="number" matInput required>
      </mat-form-field>

      <br>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary mx-auto" (click)="closeModal('text');">Sulge</button>
        <button type="submit" (click)="addQuestion('Text')" class="btn btn-success mx-auto">Lisa küsimus</button>
        <button type="reset" class="btn btn-danger mx-auto" (click)="emptyChoices()">Tühjenda kõik väljad</button>
      </div>
    </form>
  </div>
</jw-modal>
